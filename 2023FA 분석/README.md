# 2023 FA Transaction

> KBO FA 데이터 분석

<br>

**💡 분석 목표**

- 2023시즌 FA 대상자들의 시장에서의 가치 예측

| 목차                                                    | 내용                                                         |
| ------------------------------------------------------- | ------------------------------------------------------------ |
| [1. EDA]                                                | KBO 역대 FA 대상자들의 데이터            |
| [2. Multiple Linear regression]                         | 다중선형회귀모델을 사용해 시장에서의 FA금액 예측                 |
| [3. 포수WAR 보정 후 재예측]                              |포수 sWAR(STAIZ WAR) + 프레이밍을 통한 추가 승수로 WAR 보정, 금액 재예측 |

<br>

## 1. EDA

## Data 설명
---

역대 KBO 리그 FA 데이터(2012~23년까지)

- 총 188개의 관측치, 14개의 변수
- 결측치 없음
- 해외 리턴 사례, 다년 계약은 제외
- 부상으로 인한 시즌OUT-> 나머지 연도 평균값으로 대체

|칼럼명 | 설명|
|:---|:---|
| X1 Pos | 포지션(SP:선발투수, RP:불펜투수, IA:코너 내야, IB: 키스톤, O: 외야수) |
| X2 Name | 선수명 |
| X2 Team | 잔류시 원소속팀명, 이적시 ex) 삼성-> SSG |
| X3 Year | 계약연수 상세 ex) 4+2, 1+1 |
| X4 Salary | 옵션포함 총액 |
| X5 Start_age | FA연도 기준 만 나이 |
| X6 3b | 3년전 sWAR |
| X7 2b | 2년전 sWAR |
| X8 1b | 1년전 sWAR |
| X9 3y_war | 3년간 war 합계 |
| X10 Start_year | FA연도 ex) 2023 |
| X11 Year_sum | 총 계약연수 |
| X12 Salary/yearly_sum | 연평균액 |
| X13 rank | 정성평가한 선수들의 시장에서의 등급, 4개의 levels('S', 'A', 'B', 'C')|
| Y Salary/yearly | 연평균액을 소수점 둘째 자리에서 반올림 |

> 2012~22시즌 FA 계약자-> train data # 167명
> 2023시즌 FA 대상자 -> test data # 21명


## 2. Multiple Linear regression

> 다중회귀분석을 통해 2023 FA대상자들의 시장에서의 예상 금액을 알아본다.

-변수간 상관계수

![상관관계](https://user-images.githubusercontent.com/63768509/227696344-198b945f-d562-4c28-a8ab-cdf44d05a958.jpg)
<br>

- x1b, x2b, x3b는 서로 상관관계가 있음
- 당연히 선수의 기량은 부상(위에서 보정),극심한 부진, 갑작스런 노쇠화를 제외하면 최근 3년 간의 war이 갑자기 크게 변화하는 일은 드물기 때문
- 모델 생성 이후 독립변수 간의 다중공선성 확인

<br>

## 모델링

- Start_age, X1b, X2b, X3b, Start_year, rank를 다중회귀모델의 변수로 사용
- But 대부분의 회귀분석 기본가정 위배(정규성, 독립성, 등분산성) -> 데이터, 모델 변환 필요

> 모델 수정 재시도
- 쿡의 거리를 통해 모델에 영향을 많이 주는 관측치 제외
- 1차 제외: 손아섭 롯데-> 4년 64억, 오지환 LG 4년 40억, 양의지 두산->NC 4년 125억, 
- 이재원 SK(SSG) 4년 69억, 손아섭 롯데 4년 98억
- 2차 제외: 김재환 4년 115억, 박건우 두산->NC 6년 100억, 김태균 한화 4년 84억, 유한준 넥센->KT 4년 60억

# 최종 모델
![모델 최종](https://user-images.githubusercontent.com/63768509/227697111-1a378fef-c262-4ee3-b71a-12d1206fd456.jpg)

> 위 모델의 경우 회귀분석의 기본 가정을 만족

![정규성](https://user-images.githubusercontent.com/63768509/227697388-c3eb7976-4cd4-45f5-a64e-3d8bf07e9b5a.jpg)<br>
![독립성](https://user-images.githubusercontent.com/63768509/227697391-ed4a93d2-9d35-4cac-8da1-30c3aa60e1af.jpg)<br>
![등분산성](https://user-images.githubusercontent.com/63768509/227697392-b73d64e9-e7a0-4534-bc93-6861b429fefb.jpg)<br>
![다중공선성](https://user-images.githubusercontent.com/63768509/227697398-5e915187-52da-44d8-8f5f-c04d2278b924.jpg)<br>

> Salary_yearly = (Start_age * -0.16351) + (X1b * 0.53815) + (X2b * 0.35259) + (X1b * 0.53815+ -367.7023) + (Start_year * 0.19172) + (rankA * -6.34136) + (rankB * -8.68242) + (rankC * -10.14557)- 367.7023

- rankA-C는 더미변수, rankA-C 모두 해당안되는 경우 -> rankS
- Adjusted R-squared: 0.8548 
- 모델의 R^2(결정계수, 설명력)이 0.8548로 굉장히 잘 예측

## 2023시즌 FA대상자들에게 모델 적용
![final](https://user-images.githubusercontent.com/63768509/227698550-5e771dbe-7541-4597-b22b-186351c47ed8.jpg)
- 강리호, 정찬헌은 미계약자
- 3/27 정찬헌 키움잔류 2년 8.6(연평균 4.3)

## 3. 포수WAR 보정 후 재예측
> 포수FA들의 연평균액의 예측과 실제 금액의 괴리가 큼

> 프레이밍을 통한 득점은 sWAR에 적용 되지 않음 

> -> 프레이밍 득점을 war로 환산(1war = 10득점으로 함)

## 적용 후 결과
![포수FA](https://user-images.githubusercontent.com/63768509/227698777-31f688c8-3529-4164-858f-151364d16077.jpg)

- 프레이밍이 좋은 유강남, 박세혁의 경우 예상 연평균액 상승

- 프레이밍에 약점이 있는 양의지, 박동원의 경우 예상 연평균액 하락

- 그러나 여전히 차이는 큼

## 마치며
- 포수FA의 경우 포지션 특성상 리그에 한정된 자원으로 프리미엄이 붙음

- 포수 포지션의 경우 특히 예상과 차이가 있음

- 극단치(너무 싸게 계약 ex)권희동, 너무 비싸게)는 회귀분석 특성상 빗나가는 경우가 있음
